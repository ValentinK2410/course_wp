# Исправление уведомления о загрузке переводов

## Проблема

Появляется уведомление:
```
Notice: Function _load_textdomain_just_in_time was called incorrectly. 
Translation loading for the miniorange-login-openid domain was triggered too early. 
This is usually an indicator for some code in the plugin or theme running too early. 
Translations should be loaded at the init action or later.
```

## Причина

Плагин `miniorange-login-openid` загружает переводы слишком рано (до хука `init`). Это не критическая ошибка, но WordPress 6.7.0 добавил проверку и выводит предупреждение.

## Решение

### Вариант 1: Подавить уведомление (рекомендуется)

Добавьте в файл `wp-config.php` или в файл `functions.php` темы следующий код:

```php
// Подавляем уведомление о ранней загрузке переводов для miniorange-login-openid
add_filter('doing_it_wrong_trigger_error', function($trigger, $function_name) {
    if ($function_name === '_load_textdomain_just_in_time' && 
        strpos(debug_backtrace()[2]['file'] ?? '', 'miniorange-login-openid') !== false) {
        return false;
    }
    return $trigger;
}, 10, 2);
```

**Или более простой вариант** - добавьте в `functions.php` темы:

```php
// Подавляем уведомление о ранней загрузке переводов
add_action('init', function() {
    if (function_exists('_doing_it_wrong')) {
        remove_action('doing_it_wrong_run', '_doing_it_wrong_run', 10, 3);
    }
}, 1);
```

### Вариант 2: Отключить отображение уведомлений (не рекомендуется)

В файле `wp-config.php` добавьте:

```php
define('WP_DEBUG', false);
define('WP_DEBUG_DISPLAY', false);
```

**Внимание:** Это отключит все уведомления об ошибках, включая важные.

### Вариант 3: Исправить плагин miniorange-login-openid (для разработчиков)

Если у вас есть доступ к коду плагина `miniorange-login-openid`, найдите место, где вызывается `load_plugin_textdomain()` или `load_textdomain()`, и убедитесь, что это происходит на хуке `init` или позже:

```php
// Неправильно (вызывается сразу при загрузке плагина):
load_plugin_textdomain('miniorange-login-openid', false, dirname(plugin_basename(__FILE__)) . '/languages');

// Правильно (на хуке init):
add_action('init', function() {
    load_plugin_textdomain('miniorange-login-openid', false, dirname(plugin_basename(__FILE__)) . '/languages');
});
```

## Проверка плагина курсов

Плагин "Курсы Про" загружает переводы правильно - на хуке `plugins_loaded`:

```php
// В course-plugin.php:
add_action('plugins_loaded', array($this, 'load_textdomain'));

public function load_textdomain() {
    load_plugin_textdomain(
        'course-plugin',
        false,
        dirname(COURSE_PLUGIN_BASENAME) . '/languages'
    );
}
```

Это соответствует рекомендациям WordPress и не вызывает уведомлений.

## Важные замечания

1. **Это не критическая ошибка** - сайт работает нормально, просто появляется уведомление
2. **Не влияет на функциональность** - переводы все равно загружаются, просто немного раньше
3. **WordPress 6.7.0+** - это новое уведомление, добавленное для улучшения качества кода плагинов

## Рекомендации

1. Используйте **Вариант 1** для подавления уведомления
2. Если возможно, свяжитесь с разработчиками плагина `miniorange-login-openid` и сообщите о проблеме
3. Следите за обновлениями плагина - возможно, разработчики исправят это в будущих версиях

## Дополнительная информация

- [WordPress Debugging](https://wordpress.org/documentation/article/debugging-in-wordpress/)
- [Loading Text Domain](https://developer.wordpress.org/reference/functions/load_plugin_textdomain/)
- [Plugin Development Best Practices](https://developer.wordpress.org/plugins/plugin-basics/best-practices/)
